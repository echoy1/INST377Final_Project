<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Home</title>
    <link rel="stylesheet" type="text/css" href="/css/bulma.css"/>
    <link rel="stylesheet" type="text/css" href="/styles/map.css" />
    <script defer src="https://use.fontawesome.com/releases/v5.3.1/js/all.js"></script>
   

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css"
      integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ=="
      crossorigin=""
    />
    <script
      src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"
      integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew=="
      crossorigin=""
    ></script>
  </head>
  <body>

    <div class="section is-centered">
    <div class="wrapper">
      <div class="container">
        <div class="wrapper">
          <div class="container">
            <nav class="level">
              <div class="level-left">
                <div class="level-item has-text-centered">
                <p class="subtitle">Home</p>
                </div>
              </div>
            </nav>
            <nav class="level">
                <div class="level-item has-text-centered">
                  <p class="title">LocalLibraries</p>
                  <img src="/public/Books.jpg" alt="" style="height: 80px;">
                </div>
            </nav>
          </div>
        </div>
          </div>
        </div>

          <div class="tabs is-centered">
            <ul>
              <li class="is-active"><a href="search.html">Home</a></li>
              <li><a href="about.html">About</a></li>
              <li><a href="contact.html">Contact</a></li>
            </ul>
          </div>
          <form class="targetForm" id="labForm">
            
            <div class="field">
              <label class="label">Library Name</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input is-rounded" type="text" placeholder="Search by library name">
                <span class="icon is-small is-left">
                  <i class="fas fa-user"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-check"></i>
                </span>
              </div>
              <!-- <p class="help is-success">This username is available</p> -->
            </div>
            
            <div class="field">
              <label class="label">Zip Code</label>
              <div class="control has-icons-left has-icons-right">
                <input class="input zip is-rounded" type="zip " placeholder="Search by zip code">
                <span class="icon is-small is-left">
                  <i class="fas fa-envelope"></i>
                </span>
                <span class="icon is-small is-right">
                  <i class="fas fa-exclamation-triangle"></i>
                </span>
              </div>
              <!-- <p class="help is-danger">This zipcode is invalid</p> -->
            </div>
            
            <div class="select is-rounded">
              <select>
                <option selected>Branch Type</option>
                <option>Branch 1</option>
                <option>Branch 2</option>
                <option>Branch 3</option>
                <option>Branch 4</option>
                <option>Branch 5</option>
              </select>
            </div>
            
            <div class="field is-grouped">
              <div class="control">
                <button class="button is-link is-rounded">Search</button>
              </div>
              </div>
            
        
    <div class="content" id="mapid">
    </div>
<script>

  const foodInspection = [
    {"name": "OUTBACK STEAKHOUSE 2145", "longitude": -76.958574, "latitude": 38.966903},
    {"name": "THE CHILDREN'S GUILD", "longitude": -76.986143, "latitude": 38.959978},
    {"name": "CADIA HEALTHCARE - HYATTSVILLE", "longitude": -76.977768, "latitude": 38.952607}
  ]

  var myMap = L.map('mapid').setView([38.9869, -76.9426], 12);

  L.tileLayer('https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}', {
  attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
  maxZoom: 18,
  id: 'mapbox/streets-v11',
  tileSize: 512,
  zoomOffset: -1,
  accessToken: 'pk.eyJ1Ijoid3RhbTI2IiwiYSI6ImNrOGp0aGJtcjA1cWQzZXMwZnBybTdlY3cifQ.kQdXdFOLYeAM4qAM-kQbdw'
  }).addTo(myMap);

  var marker = L.marker([38.9860, -76.9451]).addTo(myMap);

  /*var circle = L.circle([38.9955, -76.9412], {
    color: 'red',
    fillColor: '#f03',
    fillOpacity: 0.5,
    radius: 500
  }).addTo(myMap);*/
  
  marker.bindPopup("UMD Mckeldin Library", {
    'className': 'customPopup'
  }).openPopup();
  
  /*var popup = L.popup()
  .setLatLng([38.9869, -76.9426])
  .setContent("I am a standalone popup.")
  .openOn(myMap);*/

  var popup = L.popup();

  function onMapClick(e) {
    popup
      .setLatLng(e.latlng)
      .setContent("You clicked the map at " + e.latlng.toString())
      .openOn(myMap);
  }

  myMap.on('click', onMapClick);

  for (let i = 0; i < foodInspection.length; i++) {
    L.marker([foodInspection[i].latitude, foodInspection[i].longitude]).addTo(myMap);
  }

</script>
<script>
  function sendForm(e) {
    e.preventDefault(); // this prevents your page reloading on button click
    const target = document.querySelector("#labForm");
    const btn = document.querySelector("#formBtn");

    const formToSend = new FormData(target);

    fetch("/api", {
      method: "PUT",
      headers: {
        "Content-Type": "application/json",
      },
      body: JSON.stringify(Object.fromEntries(formToSend)),
    })
      .then((data) => data.text()) // note: we didn't send JSON, so there's no JSON to get.
      .then((txtresponse) => {
        console.log(txtresponse);
        btn.setAttribute("disabled", true);
        const br = document.createElement("br");
        target.append(br);
        target.append(`${txtresponse}`);
      });
  }
  

  const formBtn = document.querySelector("#formBtn");
  formBtn.addEventListener("click", sendForm);
</script>
</div>
</div>
</div>
</section>
  </body>
</html>
